# Руководство по полному переносу проекта

Этот документ описывает полный и профессиональный процесс переноса всего проекта Phoebe CMS
на другой компьютер, включая кодовую базу, данные и конфигурационные файлы.

---

## Концепция переноса

Перенос проекта состоит из двух основных частей:

1.  **Перенос кодовой базы**: Все файлы, которые отслеживаются системой контроля версий Git.
2.  **Перенос данных и конфигурации**: Файлы, которые намеренно исключены из Git с помощью `.gitignore`
    (дампы баз данных, переменные окружения, логи, файлы IDE).

Простой `git clone` перенесет только первую часть. Это руководство описывает, как перенести обе.

---

## Шаг 1: Подготовка к переносу на старом компьютере

### 1.1 Создание актуальных дампов баз данных

**Важно**: Этот шаг является **первым и самым главным**. Перед переносом кода или созданием архива
убедитесь, что у вас есть свежие резервные копии всех важных баз данных.

Подробные инструкции по инвентаризации и созданию дампов для всех Docker-вольюмов находятся
в отдельном руководстве:

**[→ Руководство по резервному копированию данных Docker](./DOCKER_DATA_RECOVERY_GUIDE_RU.md)**

### 1.2 Синхронизация кодовой базы с GitHub

Убедитесь, что все ваши последние изменения в коде закоммичены и отправлены на GitHub.

```bash
git status
git add .
git commit -m "Подготовка к переносу проекта"
git push
```

### 1.3 Очистка от временных файлов

Перед созданием архива важно удалить временные файлы и логи, чтобы не переносить "мусор".

1.  **Очистка сборочных артефактов Gradle**:
    Эта команда удалит директорию `build/` в бэкенд-модуле.
    ```bash
    ./gradlew clean
    ```

2.  **Очистка логов** (если они есть):
    ```bash
    rm -rf logs/
    ```

### 1.4 Архивация файлов, не входящих в Git

Это самый важный шаг для переноса данных. Мы создадим архив, который будет содержать все файлы,
игнорируемые Git.

1.  **Создайте список игнорируемых файлов**:
    Эта команда найдет все файлы, которые соответствуют правилам в `.gitignore`, и запишет их в `ignored_files.txt`.
    ```bash
    git ls-files --ignored --exclude-standard > ignored_files.txt
    ```

2.  **Создайте архив**:
    Эта команда создаст `phoebe_transfer_archive.tar.gz`, содержащий все файлы из списка.
    ```bash
    tar -czvf phoebe_transfer_archive.tar.gz -T ignored_files.txt
    ```

- **Результат**: У вас будет один архив `phoebe_transfer_archive.tar.gz`, содержащий все ваши дампы,
  `.env.dev` файлы и другие важные данные.

---

## Шаг 2: Перенос данных на новый компьютер

Перенесите на новый компьютер следующие артефакты:

1.  **URL вашего Git-репозитория**.
2.  **Архив `phoebe_transfer_archive.tar.gz`** (например, с помощью флешки, облачного хранилища или `scp`).

---

## Шаг 3: Развертывание на новом компьютере

1.  **Клонируйте репозиторий**:
    ```bash
    git clone <URL_вашего_репозитория>
    cd phoebe
    ```

2.  **Распакуйте архив**:
    Поместите `phoebe_transfer_archive.tar.gz` в корень проекта и выполните команду:
    ```bash
    tar -xzvf phoebe_transfer_archive.tar.gz
    ```
    Эта команда восстановит все ваши игнорируемые файлы в их исходных директориях (`db_dumps/`, `.env.dev` и т.д.).

3.  **Запустите Docker-контейнеры**:
    ```bash
    docker compose up -d mysql
    ```

4.  **Восстановите базу данных из дампа**:
    ```bash
    docker exec -i phoebe-mysql mysql -uroot -proot < db_dumps/phoebe_new_db_backup.sql
    ```

5.  **Запустите приложение**:
    ```bash
    ./gradlew bootRun --args='--spring.profiles.active=local,mysql'
    ```

Теперь ваш проект полностью перенесен и готов к работе на новом компьютере.

**Примечание**: Приложение Spring Boot обычно запускается напрямую с помощью `./gradlew bootRun`,
а не внутри отдельного Docker-контейнера.
