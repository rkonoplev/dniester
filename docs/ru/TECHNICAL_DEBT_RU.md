# Технический долг и история улучшений

Этот документ отслеживает историю значимых улучшений, текущие задачи и будущие планы по развитию проекта.

---

## Завершенные задачи и архитектурные решения

Этот раздел служит журналом изменений, документируя ключевые реализованные возможности и рефакторинги,
основанные на анализе текущего состояния кодовой базы.

### Архитектура и Дизайн
- **Слоёная архитектура**: Реализовано четкое разделение на слои Controller, Service и Repository.
- **Принцип единой ответственности**: Логика разделена по доменным областям (новости, роли, авторизация).
- **DTO-паттерн**: Используются Data Transfer Objects для всех API-запросов и ответов, обеспечивая
  изоляцию внутренней модели.
- **Централизованная авторизация**: Логика проверки прав доступа вынесена в `AuthorizationService`.
- **Автоматическое маппинг**: Внедрен MapStruct для автоматического преобразования между DTO и сущностями.

### Безопасность
- **Аутентификация и авторизация**: Интегрирован Spring Security с базовой аутентификацией.
- **Ролевая модель (RBAC)**: Реализована система с ролями (ADMIN, EDITOR) и гранулярными разрешениями.
- **Защита эндпоинтов**: Административные API защищены и требуют соответствующих ролей.

### Производительность
- **Кэширование**: Внедрено кэширование на уровне методов (`@Cacheable`) с использованием Caffeine для
  часто запрашиваемых данных.
- **Ограничение частоты запросов (Rate Limiting)**: Реализована защита API от флуда с помощью Bucket4j.
- **Оптимизация транзакций**: Все методы сервисов, предназначенные только для чтения, аннотированы
  `@Transactional(readOnly = true)`.

### База данных
- **Доступ к данным**: Проект использует блокирующий стек **Spring Data JPA** для простоты и надежности.
- **Управление миграциями**: Схема базы данных управляется с помощью Flyway, обеспечивая версионирование.
- **Поддержка нескольких СУБД**: Архитектура поддерживает как MySQL, так и H2 (для тестов).

### Качество кода и CI/CD
- **Статический анализ**: Настроены и интегрированы Checkstyle и PMD для поддержания качества кода.
- **Тестовое покрытие**: Интегрирован JaCoCo для анализа покрытия кода тестами.
- **Рефакторинг тестовой структуры**: Проведено полное разделение тестов на юнит- и интеграционные
  (`unit/` и `integration/`).
- **Настройка Gradle**: `build.gradle` сконфигурирован для раздельного запуска юнит- и интеграционных тестов.
- **Интеграция Testcontainers**: Внедрены Testcontainers для надежного интеграционного тестирования с
  реальной БД (MySQL), обеспечивая изолированную и чистую тестовую среду.

---

## В процессе

- **Производительность API**: Дальнейшая оптимизация запросов для сценариев с высоким трафиком.

---

## Будущие планы

Этот раздел описывает запланированные функции и улучшения, сгруппированные по приоритетам.

### Безопасность (Высокий приоритет)

- **OAuth 2.0 + JWT**: Заменить Basic Auth на современную аутентификацию на основе токенов для
  повышения безопасности.
- **2FA для ADMIN/EDITOR**: Внедрить двухфакторную аутентификацию для критически важных ролей пользователей.

### Функциональность (Средний приоритет)

- **Загрузка файлов**: Реализовать поддержку загрузки и управления изображениями и другими медиафайлами
  напрямую через API.
- **Расширенный поиск**: Интегрировать полнотекстовый поисковый движок, такой как Elasticsearch или Lucene.
- **Веб-хуки (Webhooks)**: Предоставить систему для отправки уведомлений о событиях во внешние сервисы.

### Архитектура и производительность (Низкий приоритет)

- **Переход на реактивный стек**: Для публичных эндпоинтов с высоким трафиком рассмотреть миграцию с
  блокирующего стека (Spring MVC/JPA) на неблокирующий, реактивный (Spring WebFlux + R2DBC) для
  максимальной масштабируемости и эффективности использования ресурсов.

### Референсные Frontend-реализации

- **Статус**: Находятся в стадии базовой структуры. Требуется полная реализация компонентов и интеграция
  с API.
- **Зависимость**: Полноценная работа над фронтендами будет продолжена после окончательной отладки,
  настройки и проверки бэкенда.
