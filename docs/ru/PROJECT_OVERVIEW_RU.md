# Обзор проекта Phoebe CMS

## Обзор проекта
**Название**: Phoebe — Open Source Headless CMS
**Тип**: Open Source Headless система управления контентом (гибридная архитектура)
**Миграция**: Drupal 6 → Современный Headless Spring Boot + Опциональный Angular Frontend
**Статус**: Headless Backend готов к продакшену, Референсный Frontend планируется
**Лицензия**: MIT (Open Source)

## Технологический стек

### Headless Backend (Готов к продакшену)
- **Фреймворк**: Spring Boot 3.x
- **Язык**: Java 21
- **База данных**: MySQL 8.0, PostgreSQL 12+ (H2 для тестов)
- **Безопасность**: Spring Security с настраиваемой аутентификацией
- **API**: REST с документацией OpenAPI/Swagger
- **Кэширование**: Caffeine (In-Memory)
- **Ограничение запросов**: Bucket4j с IP-based buckets
- **Сборка**: Gradle 8.7
- **Тестирование**: JUnit 5, интеграционные тесты с H2
- **Миграция**: Spring Boot миграции (V1-V6)

### Референсный Frontend (Опциональный)
- **Фреймворк**: Angular с Angular Universal
- **Назначение**: Референсная реализация для быстрого развертывания.
- **Дизайн**: Чистый, адаптивный макет.
- **SEO**: Статические URL, SSR, JSON-LD, OpenGraph метаданные
- **Брендинг**: Настраиваемая система тем
- **Функции**: Поиск, темная тема, push-уведомления (планируется)

### Инфраструктура
- **Контейнеризация**: Docker + Docker Compose
- **CI/CD**: GitHub Actions
- **Качество кода**: Checkstyle, PMD, JaCoCo coverage
- **База данных**: MySQL или PostgreSQL с Docker
- **Безопасность**: GitLeaks сканирование секретов

## Гибридная Headless архитектура

**Phoebe** следует **гибридному Headless** подходу, обеспечивая максимальную гибкость:

- **Headless ядро**: Полный REST API для разработки пользовательских frontend
- **Референсный Frontend**: Опциональное Angular приложение для быстрого развертывания
- **API-First**: Вся функциональность доступна через REST endpoints
- **Без привязки к поставщику**: Используйте наш frontend или создайте свой

## Структура проекта
```
phoebe/
├── backend/                    # Headless Spring Boot API
│   ├── src/main/java/com/example/phoebe/
│   │   ├── config/            # Конфигурации безопасности, тестов, ограничений, кэша
│   │   ├── controller/        # REST endpoints (Admin + Public)
│   │   ├── dto/              # Data Transfer Objects
│   │   ├── entity/           # JPA сущности (News, User, Term, Role)
│   │   ├── exception/        # Пользовательские исключения + глобальный обработчик
│   │   ├── filter/           # Фильтр ограничения запросов
│   │   ├── mapper/           # Маппинг Entity-DTO
│   │   ├── repository/       # JPA репозитории
│   │   └── service/          # Бизнес-логика
│   ├── src/main/resources/
│   │   ├── db/migration/     # Spring Boot миграции
│   │   ├── application*.yml  # Конфигурации окружений
│   │   └── static/           # Статические ресурсы
│   └── src/test/             # Unit + интеграционные тесты
├── frontend/                  # Референсное Angular UI (опционально)
├── docs/                     # Документация (английская и русская)
├── .github/workflows/        # CI/CD пайплайны
├── docker-compose.yml        # Среда разработки
└── README.md                 # Документация проекта
```

## Основные сущности и схема базы данных

### News (таблица content)
- **Описание**: Гибкая сущность для контента, может представлять статьи, страницы и т.д.
- **Связи**: ManyToOne → User (автор), ManyToMany → Term (категории/теги)

### User (таблица users)
- **Описание**: Аутентификация и авторизация с ролевым доступом.
- **Связи**: OneToMany → News, ManyToMany → Role

### Term (таблица terms)
- **Описание**: Система таксономии с группировкой по словарям.
- **Связи**: ManyToMany → News

### Role (таблица roles)
- **Описание**: Роли ADMIN, EDITOR с детализированными разрешениями.
- **Связи**: ManyToMany → User, ManyToMany → Permission

### Permission (таблица permissions)
- **Описание**: Детализированные разрешения (например, `news:read`, `users:create`).

## Headless API Endpoints

### Public Content API (`/api/public/news`)
- `GET /` - Поиск опубликованного контента (пагинация, фильтры).
- `GET /{id}` - Получить опубликованный контент по ID.
- `GET /term/{termId}` - Получить контент по ID термина.
- `GET /terms?termIds=1,3,5` - Получить контент по нескольким ID терминов.

### Content Management API (`/api/admin/news`)
- `GET /` - Поиск всего контента (опубликованного и черновиков).
- `POST /` - Создать новый контент.
- `PUT /{id}` - Обновить существующий контент.
- `DELETE /{id}` - Удалить контент.

## Профили конфигурации

Проект использует профили Spring Boot для управления конфигурацией в различных средах (локальная,
тестовая, продакшен). Каждый профиль представлен отдельным `application-{profile}.yml` файлом.

Подробное описание всех профилей и их настроек доступно в [Руководстве по конфигурации](CONFIG_GUIDE_RU.md).

## Ключевые проектные решения

1. **Гибридная Headless архитектура**: API-first с опциональным референсным frontend.
2. **Open Source**: MIT лицензия для свободного использования и модификации.
3. **Фокус на гибкость**: Спроектировано как универсальный контент-хаб.
4. **API-First**: Вся функциональность доступна через REST endpoints.
5. **Без привязки к поставщику**: Свобода выбора любой frontend-технологии.
6. **Профессиональный уровень**: Безопасность, кэширование и ограничение запросов корпоративного уровня.
7. **Дружелюбность к миграции**: Инструменты для миграции с устаревших CMS.
8. **Docker First**: Контейнеризованная разработка и развертывание.
9. **Современный стек**: Java 21, Spring Boot 3.x, MySQL 8.0, PostgreSQL 12+.
10. **Расширяемость**: Архитектура, готовая к плагинам и интеграциям.

## Целевая аудитория

### Профессиональные команды разработки
- Агентства, требующие кастомные frontend-решения для клиентов.
- Компании с существующими мобильными приложениями, которым нужен бэкенд для контента.
- Организации, которым требуется распространение контента на несколько платформ.

### Бизнес и организации
- Компании, которым нужен надежный и современный бэкенд для сайта.
- Стартапы, ищущие экономичные и масштабируемые CMS-решения.
- Организации, мигрирующие с устаревших или монолитных платформ.
- Команды, которые хотят начать с референсной реализации и кастомизировать ее.

Этот документ предоставляет полный контекст для понимания headless архитектуры Phoebe CMS, текущих
возможностей и видения современной, гибкой системы управления контентом.