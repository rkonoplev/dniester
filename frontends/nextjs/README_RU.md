# Phoebe CMS - Эталонная реализация фронтенда на Next.js

Эта директория содержит эталонную реализацию фронтенда на Next.js для Phoebe Headless CMS.

**[English documentation](README.md)**
Она предоставляет современный, адаптивный новостной портал с полноценной админ-панелью.

## 1. Цель и задачи

Основная цель этого фронтенда — продемонстрировать надежное, SEO-оптимизированное
и ориентированное на пользователя приложение, построенное на бэкенде Phoebe CMS.
Оно следует принципам дизайна, вдохновленным Google News, и реализует ключевые
функции для потребления и управления контентом.

## 2. Реализованные функции

### 2.1. Базовая настройка и инфраструктура
*   Проект Next.js инициализирован с React, Material UI (MUI) и Axios.
*   Интеграция с Docker: `Dockerfile` для Next.js приложения и обновленный
    `docker-compose.yml` для включения сервиса `nextjs-app`, доступного на порту `3000`.
*   Конфигурация переменных окружения для базового URL API бэкенда (`.env.local`).

### 2.2. Пользовательский интерфейс и темы
*   Пользовательская тема Material UI с опциями светлого и темного режимов,
    переключаемых через футер. Цвета темы соответствуют `FRONTEND_SPEC_NEXTJS.md`.
*   Глобальный компонент `Layout`, обеспечивающий единообразные заголовок,
    область основного контента и футер.
*   Пользовательская страница `404` Not Found для необработанных маршрутов.

### 2.3. Аутентификация и авторизация
*   `AuthContext` для глобального управления состоянием аутентификации пользователя
    и ролями (ADMIN/EDITOR).
*   Страница входа (`/admin/login`) с надежной фронтенд-валидацией имени
    пользователя и пароля.
*   Компоненты `ProtectedRoute` и `AdminRoute` для контроля доступа к
    админ-разделам на основе ролей.
*   Динамический `AdminBar`, отображаемый только для аутентифицированных
    пользователей, со ссылками навигации, адаптированными под их роли
    (например, "Taxonomy" и "Users" только для ADMINов).

### 2.4. Публичные страницы контента
*   **Главная страница (`/`)**: Отображение последних новостных статей,
    рендеринг на стороне сервера (SSR).
*   **Страница детализации статьи (`/node/[id]`)**: Статическая генерация сайта (SSG)
    с инкрементальной статической регенерацией (ISR) для оптимальной
    производительности и SEO. Отображает полный `body` статьи.
*   **Страница категории (`/category/[id]`)**: Список статей, принадлежащих
    к определенной категории, рендеринг на стороне сервера (SSR).
*   **Страница поиска (`/search`)**: Фронтенд-форма поиска, интегрированная
    с бэкенд API. Результаты отображают `teaser` контента статьи.
*   **Информационные страницы**: Страницы-заглушки для ссылок в футере
    (например, Technical Sheet, Contact).

### 2.5. Админ-панель (CRUD операции)
*   **Управление новостями**:
    *   Список всех новостных статей (`/admin/news`) с пагинацией,
        опциями редактирования и удаления.
    *   Создание новых статей (`/admin/news/new`).
    *   Редактирование существующих статей (`/admin/news/edit/[id]`).
    *   Фронтенд-валидация для полей `title` (5-50 символов), `teaser`
        (10-250 символов) и `body` (мин. 20 символов), согласованная с
        правилами бэкенда.
    *   Поля `teaser` и `body` поддерживают HTML-контент, изображения
        и YouTube-вставки.
*   **Управление таксономией**:
    *   Список всех терминов (`/admin/taxonomy`) с опциями редактирования
        и удаления.
    *   Создание новых терминов (`/admin/taxonomy/new`).
    *   Редактирование существующих терминов (`/admin/taxonomy/edit/[id]`).
    *   Фронтенд-валидация для полей `name` (2-100 символов), `vocabulary`
        (2-50 символов) и `description` (макс. 500 символов).
*   **Управление пользователями**:
    *   Список всех пользователей (`/admin/users`).
    *   Редактирование ролей пользователей (`/admin/users/edit/[id]`)
        с фронтенд-валидацией.

### 2.6. Валидация и обработка контента
*   Комплексная фронтенд-валидация реализована во всех основных формах
    для улучшения UX и снижения нагрузки на сервер, строго следуя
    правилам, определенным в `VALIDATION_GUIDE.md`.
*   Поля `teaser` и `body` корректно отображают HTML-контент и YouTube-вставки
    с использованием `dangerouslySetInnerHTML`, используя обработку `SafeHtml`
    бэкенда.

## 3. Начало работы

### 3.1. Предварительные требования
*   Node.js (v18+) и npm/yarn
*   Docker и Docker Compose
*   Запущенный бэкенд Phoebe CMS (как настроено в `docker-compose.yml`)

### 3.2. Запуск приложения
1.  Перейдите в корневую директорию проекта (`phoebe/`).
2.  Убедитесь, что ваш файл `.env.local` в `frontends/nextjs/` правильно
    сконфигурирован (например, `NEXT_PUBLIC_API_BASE_URL=http://news-app:8080/api/public`).
3.  Запустите все сервисы с помощью Docker Compose:
    ```bash
    docker-compose up --build
    ```
4.  Откройте фронтенд Next.js в браузере по адресу `http://localhost:3000`.
5.  Откройте страницу входа в админ-панель по адресу `http://localhost:3000/admin/login`.

## 4. Следующие шаги и дальнейшее развитие
*   Реализация расширенной функциональности поиска (например, с помощью
    Pagefind для статического контента).
*   Интеграция OAuth 2.0 + JWT для усиленной безопасности аутентификации.
*   Добавление возможностей загрузки файлов для изображений и других медиа.
*   Улучшение UI/UX на основе детальных макетов дизайна.

## 5. Переключение на альтернативный фронтенд (например, Angular)

Если вы хотите использовать альтернативный фронтенд (например,
запланированную версию на Angular) и отключить эту реализацию на Next.js,
вам потребуется изменить основной файл `docker-compose.yml`.

1.  Откройте `phoebe/docker-compose.yml`.
2.  Найдите и удалите или закомментируйте блок сервиса `nextjs-app`:
    ```yaml
    # nextjs-app:
    #   build:
    #     context: ./frontends/nextjs
    #     dockerfile: Dockerfile
    #   container_name: nextjs-app
    #   restart: always
    #   depends_on:
    #     news-app:
    #       condition: service_healthy
    #   ports:
    #     - "3000:3000"
    #   volumes:
    #     - ./frontends/nextjs:/app
    #     - /app/node_modules
    #     - /app/.next
    ```
3.  Затем вы добавите конфигурацию для вашего альтернативного фронтенд-сервиса.
